---
- name: 'create riot-web folder'
  file:
    path: '/srv/riot-web'
    state: 'directory'
    mode: '0755'
    owner: 'www-data'
    group: 'www-data'
  tags:
    - 'packages'

- name: 'download riot-web'
  unarchive:
    src: "https://github.com/vector-im/riot-web/releases/download/\
      {{ riot_web_version }}/riot-{{ riot_web_version }}.tar.gz"
    dest: '/srv/riot-web'
    remote_src: true
    owner: 'www-data'
    group: 'www-data'
  tags:
    - 'packages'

- name: 'configure nginx location'
  template:
    src: 'riot.conf'
    dest: '/etc/nginx/locations/{{ server_fqdn }}/riot.conf'
  notify:
    - 'reload nginx'

- name: 'configure riot web'
  template:
    src: 'config.json.j2'
    dest: '/srv/riot-web/riot-{{ riot_web_version }}/config.json'
...
